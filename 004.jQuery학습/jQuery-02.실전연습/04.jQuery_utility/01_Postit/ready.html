<!DOCTYPE HTML>
<html>
<head>
<meta charset="utf-8">

<title>drag and drop 기능</title>
<script src="jquery-1.7.2.min.js"></script>
<script src="jquery-ui.min.js"></script>
<!-- 드래그 앤 드롭기능을 사용하려면 반드시 제이쿼리 라이브러리 아래에 제이쿼리 UI를 불러와서 아래쪽에서 호출코딩을 해야한다! -->
<script>
	$(function(){ ////////////////////////////// JQB //////////////////////////////

		// [ 드래그 기능 적용하기 ]
		// 제이쿼리 UI의 draggable() 메서드를 호출함
		// 대상 : .draggable
		$(".draggable").draggable({
			cursor : "move", // 커서모양 "이동중"표시로 변경
			stack : ".draggable", // 드래그 대상 상위처리 (선택요소)
			opacity : 0.7 // 이동 중 투명도 설정
		}); ///// draggable /////

		// 1. 드래그가 시작 될때 배경이미지 class로 변경하기
		// 이벤트 종류 : dragstart (드래그 시작시 발생하는 이벤트)
		// 이벤트와 함수를 묶어주는 메서드를 사용함!
		// -> on(이벤트명, 함수)
		// 대상 : .draggable
		$(".draggable").on("dragstart",function(){
			// console.log("드래그시작");
			$(this).addClass("invert");
		}); ///// dragstart 함수 /////

		// 2. 드래그가 끝날때 배경이미지 class로 변경하기
		// 이벤트 종류 : dragstop (드래그 끝날때 발생하는 이벤트)
		// 이벤트와 함수를 묶어주는 메서드를 사용함!
		// -> on(이벤트명, 함수)
		// 대상 : .draggable
		$(".draggable").on("dragstop",function(){
			// console.log("드래그끝");
			$(this).removeClass("invert");
		}); ///// dragstop 함수 /////


		// 드롭할때 발생하는 이벤트 처리하기
		// droppable() 메서드 : 드롭되는 요소처리 
		// 이벤트 대상 : .dropshow
		$(".dropshow").droppable({
			// 드롭처리 속성 -> drop : 함수
			drop : function(evt,ui){
				// evt - 이벤트 전달 변수 , ui - 드롭관련객체
				// console.log("나, 빠졌다!")

				// 1. 드롭된 요소의 이미지의 src를 읽어옴
				// 드롭된 요소는 -> ui.draggable
				let isrc = ui.draggable.find("img").attr("src");
				// console.log("이미지경로"+isrc);

				// 2. 드롭영역의 배경이미지 변경하기
				// $(this) === $(".dropshow")
				$(this).css({
					backgroundImage: "url(" + isrc + ")"
				}); ////////////// css //////////////

				// 3. 드롭된 요소의 자식 p태그의 글자 읽어오기
				let dtxt = ui.draggable.find("p").text();
				// console.log("글자:"+dtxt);

				// 4. 드롭영역의 배경글자 변경하기
				// $(this) === $(".dropshow")
				$(this).text(dtxt+" 당첨!");

				// 5. 드롭된 요소 사라지게 하기
				ui.draggable.hide();

				// 6. 유튜브 동영상 박스 넣기
				$("body").append('<div id="mbox"></div>');

				// 7. 동영상 박스 CSS세팅하기
				$("#mbox").css({
					position : "fixed",
					top : "0",
					left : "0",
					width : "100%",
					height : "100%",
					zIndex : "999",
					backgroundColor : "#000"
				}); ////////// css /////////

				// 8. 동영상 박스에 유튜브 iframe 넣기
				$("#mbox").html(
					'<iframe width="100%" height="100%" src="https://www.youtube.com/embed/uWOt_OejMFg?autoplay=1" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>'
				)
				// 9. 동영상 박스 숨겼다가 1초후 슬라이드 다운으로 보이기
				.hide().delay(1000).slideDown(2000);

			} ///// drop 속성 /////

		}); ///// droppavle /////
		/////////////////////////

	}); ////////////////////////////// JQB //////////////////////////////
</script>
<style>

div.draggable {
	float:left;
	width: 160px;
	height: 160px;
	padding:10px 0px 0px 20px;
	background:url(post.png) no-repeat;
	font-size: 14px;
}

div.draggable img{
	width: 130px;
	height: 80px;
}

div.invert {  background:url(post2.png) no-repeat;}

/* 드롭박스 */
.dropshow{
	width: 500px;
	height: 400px;
	text-align: center;
	background: url(addimg/effect2.jpg) no-repeat center/cover;
	font: bold 36px/400px "맑은고딕","굴림";
	color: #f00;
	text-shadow: 1px 0 #fff, -1px 0 #fff,
				0 1px #fff, 0 -1px #fff,;
	margin: 50px auto;/* 가로중앙 */
}

/* 드래그박스 */
.dbox{
	width: 720px;
	height: 170px;
	margin: 0 auto;
	border: 2px dashed blue;
}

</style>

</head>

<body>

<!-- 드롭 박스 -->
<div class="dropshow">
	여기에 드롭하세요!
</div>

<!-- 드레그 박스 -->
<div class="dbox">
	<div class="draggable">
		<p>쇼핑몰 자유이용권</p>
		<img src="addimg/gm.jpg" alt="쥐마켓">
	</div>

	<div class="draggable">
		<p>노떼월드 자유이용권</p>
		<img src="addimg/lottee.jpg" alt="노떼월드">
	</div>

	<div class="draggable">
		<p>큐챠 자유이용권</p>
		<img src="addimg/coocha.jpg" alt="큐챠">
	</div>

	<div class="draggable">
		<p>해외여행 자유이용권</p>
		<img src="addimg/effect1.jpg" alt="허나투어">
	</div>
</div>



</body>
</html>














